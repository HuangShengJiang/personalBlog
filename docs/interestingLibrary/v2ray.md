---
title: V2Ray
date: 2018-12-18
categories: 
 - Library
tags: 
 - tool
---

> V2Ray åƒæ˜¯ä¸€ä¸ªé›†æˆå·¥å…·ï¼Œå®ƒé›†åˆäº†å¤šç§å¤šæ ·çš„åè®®å’ŒåŠŸèƒ½ï¼Œå¯¹ä¸ªäººç”¨æˆ·è€Œè¨€åƒæ˜¯ä¸€ä¸ªå·¥å…·ç®±ï¼Œå¯ä»¥ä½¿ç”¨å„ç§å„æ ·çš„å·¥å…·ç»„åˆã€‚
å¯¹å¼€å‘è€…è€Œè¨€åƒæ˜¯ä¸€ä¸ªè„šæ‰‹æ¶ï¼Œå¯ä»¥åœ¨æ­¤åŸºç¡€ä¸Šå¼€å‘æ‰©å……è‡ªå·±éœ€è¦çš„åŠŸèƒ½è€ŒèŠ‚çœå¼€å‘æ—¶é—´ã€‚

## ä½¿ç”¨ v2ray æ­æ¢¯å­
1. å‡†å¤‡ææ–™ï¼š ä¸€å°å¯ä»¥è®¿é—®å›½å¤–ç½‘ç«™çš„æœåŠ¡å™¨ï¼Œä¸€å°å¯ä»¥ä¸Šç½‘çš„ç”µè„‘

2. å®‰è£…æœåŠ¡å™¨ä¸Šçš„v2ray(ä»¥Centos 7ä¸ºä¾‹)

    æœ€æ–°ç‰ˆçš„v2rayå®‰è£…å¯ä»¥è¯´æ˜¯ç›¸å½“å‚»ç“œå¼äº†ï¼Œæ‰§è¡Œå‡ è¡Œå‘½ä»¤å°±å¯ä»¥æŠŠv2rayå®‰è£…å¥½ï¼š
    * æ ¸å¯¹ç³»ç»Ÿç³»ç»Ÿæ—¶é—´ï¼Œè¦æ±‚æœåŠ¡å™¨ä¸å®¢æˆ·ç«¯çš„æ—¶é—´è¯¯å·®ä¸è¶…è¿‡1åˆ†é’Ÿï¼ˆæ³¨æ„ï¼šå¦‚æœæœåŠ¡å™¨æ˜¯å›½å¤–çš„ï¼Œåˆ™è¦æ³¨æ„æ—¶åŒºçš„é—®é¢˜ï¼‰;
    
    * è¿è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚
        ä¸‹è½½è„šæœ¬:
        ``` 
        $ wget https://install.direct/go.sh
        ```
        
        ä¸Šé¢å‘½ä»¤å¦‚æœæŠ¥ wget not found çš„é”™è¯¯ï¼Œåˆ™éœ€è¦æ‰§è¡Œ wget çš„å®‰è£…å‘½ä»¤ï¼š
        ``` 
        $ yum -y install wget
        ```
        
        ä¸‹è½½å¥½è„šæœ¬åï¼Œæ‰§è¡Œè„šæœ¬å®‰è£… v2ray:
        ``` 
        $ sudo bash go.sh
        ```
        
        æ¥ä¸‹æ¥â€¦â€¦ æ²¡æœ‰äº†ï¼Œå¯ä»¥å¯åŠ¨äº†ğŸ˜
        
        å¯åŠ¨ v2rayçš„å‘½ä»¤:
        ``` 
        $ sudo systemctl start v2ray
        ```
        
        åœæ­¢ v2rayçš„å‘½ä»¤:
        ``` 
        $ sudo systemctl stop v2ray
        ```
        
        é‡å¯ v2rayçš„å‘½ä»¤:
        ``` 
        $ sudo systemctl restart v2ray
        ```
        
3. å®‰è£…å®¢æˆ·ç«¯ä¸Šçš„v2ray(ä»¥Win10ä¸ºä¾‹)
    * Win10ä¸Šçš„å®‰è£…æ›´åŠ ç®€å•ï¼Œå°±æ˜¯ç›´æ¥å»å®˜ç½‘ä¸‹è½½ä¸ªzipåŒ…è§£å‹å°±èƒ½ç”¨ï¼Œåªè¦è¿è¡Œè§£å‹æ–‡ä»¶é‡Œçš„ v2ray.exe
    * å¦å¤–æœ‰ä¸¤ç§æ–¹å¼è®¾ç½®ä»£ç†ï¼Œä¸€ç§æ˜¯é…ç½®æµè§ˆçš„ä»£ç†ï¼Œå¦ä¸€ç§æ˜¯ä½¿ç”¨å·¥å…·é…ç½®ç³»ç»Ÿä»£ç†
    
        ä»¥firefox ä¸ºä¾‹, èœå• -> é€‰é¡¹ -> ç½‘ç»œè®¾ç½®:
        
        ![æµè§ˆå™¨è®¾ç½®](/img/firefox_setting.png)
        
    * psï¼šè¿™é‡Œè¿è¡Œv2ray.exe å‡ºç°çš„æ˜¯å‘½ä»¤è¡Œï¼Œä¸æ˜¯å¾ˆå‹å¥½ã€‚æ¨èå»ä¸‹è½½ä¸ªv2rayNï¼ˆå¯è§†åŒ–çš„å·¥å…·ï¼‰;

4. ä¿®æ”¹æœåŠ¡å™¨ä¸Š v2rayçš„config.js
    å…¶å®å¦‚æœåªæ˜¯æƒ³è¦è·‘é€šï¼ŒæœåŠ¡å™¨çš„config.jså¯ä»¥ä¸ç”¨æ”¹ï¼Œ
    åªè¦å»æŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶ï¼Œæ‹¿åˆ° `inbound.port` ã€`inbound.settings.clients.id`ã€`inbound.settings.clients.alterId` ååœ¨å®¢æˆ·ç«¯config.jsä¸­å¡«å…¥ï¼Œå…·ä½“çœ‹ä¸‹ä¸€éƒ¨åˆ†ã€‚
    å¦‚æœä½ æœ‰ä¸ªæ€§åŒ–çš„è®¾ç½®ï¼Œè®°å¾—åœ¨è®¾ç½®åï¼ŒéªŒè¯config.js æœ‰æ•ˆæ€§å†é‡å¯v2rayï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š
    ``` 
    $ /usr/bin/v2ray/v2ray -test -config /etc/v2ray/config.json
    ```
    æŸ¥çœ‹æœåŠ¡å™¨ä¸Šv2rayçš„è¿è¡ŒçŠ¶æ€
   ``` 
   $  service v2ray status
   ``` 
   
    
5. ä¿®æ”¹å®¢æˆ·ç«¯ä¸Š v2rayçš„config.js

    ä»¥ä¸‹æ˜¯æˆ‘å®¢æˆ·ç«¯é…ç½®ï¼Œå¤§ä¼™å‚è€ƒä¸€ä¸‹å°±å¥½,ä¸»è¦å°±ä¿®æ”¹äº†å››å¤„åœ°æ–¹ï¼š
    `outbound.settings.vnext[0].address`ã€`outbound.settings.vnext[0].port`ã€`outbound.settings.vnext[0].users[0].id`ã€`outbound.settings.vnext[0].users[0].alterId`

    ``` 
    {
      "log": {
        "access": "",
        "error": "",
        "loglevel": ""
      },
      "inbound": {
        "port": 1080,
        "listen": "0.0.0.0",
        "protocol": "socks",
        "settings": {
          "auth": "noauth",
          "udp": true,
          "ip": "127.0.0.1",
          "clients": null
        },
        "streamSettings": null
      },
      "outbound": {
        "tag": "agentout",
        "protocol": "vmess",
        "settings": {
          "vnext": [
            {
              "address": "æœåŠ¡å™¨ip",
              "port": "æœåŠ¡å™¨ä¸Šconfig.jsä¸­çš„port",
              "users": [
                {
                  "id": "æœåŠ¡å™¨ä¸Šconfig.jsä¸­çš„id",
                  "alterId": "æœåŠ¡å™¨ä¸Šconfig.jsä¸­çš„alterId",
                  "security": "aes-128-gcm"
                }
              ]
            }
          ],
          "servers": null
        },
        "streamSettings": {
          "network": "tcp",
          "security": "",
          "tcpSettings": null,
          "kcpSettings": null,
          "wsSettings": null
        },
        "mux": {
          "enabled": true
        }
      },
      "inboundDetour": null,
      "outboundDetour": [
        {
          "protocol": "freedom",
          "settings": {
            "response": null
          },
          "tag": "direct"
        },
        {
          "protocol": "blackhole",
          "settings": {
            "response": {
              "type": "http"
            }
          },
          "tag": "blockout"
        }
      ],
      "dns": {
        "servers": [
          "8.8.8.8",
          "8.8.4.4",
          "localhost"
        ]
      },
      "routing": {
        "strategy": "rules",
        "settings": {
          "domainStrategy": "IPIfNonMatch",
          "rules": [
            {
              "type": "field",
              "port": null,
              "outboundTag": "direct",
              "ip": [
                "0.0.0.0/8",
                "10.0.0.0/8",
                "100.64.0.0/10",
                "127.0.0.0/8",
                "169.254.0.0/16",
                "172.16.0.0/12",
                "192.0.0.0/24",
                "192.0.2.0/24",
                "192.168.0.0/16",
                "198.18.0.0/15",
                "198.51.100.0/24",
                "203.0.113.0/24",
                "::1/128",
                "fc00::/7",
                "fe80::/10"
              ],
              "domain": null
            }
          ]
        }
      }
    }
    ```

6. å¯åŠ¨å®¢æˆ·è¯•è¯•çœ‹ã€‚æ›´å¤šé…ç½®å¯ä»¥å‚è€ƒ [v2ray_é…ç½®æ–‡ä»¶](https://www.v2ray.com/chapter_02/)

## è¸©åˆ°çš„å‘
1.  å…¶å®æŒ‰ç…§æ•™ç¨‹ä¸€æ­¥æ­¥å¾€ä¸‹èµ°å¹¶æ²¡æœ‰å…¶ä»–å¾ˆå¤§çš„å‘ï¼Œæˆ‘é…äº†ä¸‰æ¬¡æ‰æˆåŠŸçš„åŸå› æ˜¯æˆ‘ç†è§£é”™äº†â€˜æ—¶é—´æ ¡å‡†â€™è¿™ä¸€æ­¥éª¤ã€‚
    å› ä¸ºv2rayçš„å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯é—´éªŒè¯æ˜¯åŒ…æ‹¬æ—¶é—´çš„éªŒè¯çš„ï¼ˆè¦æ±‚å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯æ—¶é—´è¯¯å·®åœ¨`ä¸€åˆ†é’Ÿ`ä¹‹å†…ï¼‰ã€‚
    ç»“æœæˆ‘ç›´æ¥æŠŠæœåŠ¡å™¨ä¸Šçš„æ—¶é—´æ”¹æˆæˆ‘ç”µè„‘ï¼ˆä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯ï¼‰çš„æ—¶é—´ï¼Œç»“æœæ— è®ºæ€ä¹ˆæ£€æŸ¥éƒ½æ£€æŸ¥ä¸å‡ºé”™åœ¨å“ªäº†ã€‚
    åæ¥é‡æ–°æŸ¥çœ‹æ–‡æ¡£ï¼ŒçŒ›ç„¶æƒ³èµ·æˆ‘æœåŠ¡å™¨æ˜¯å›½å¤–çš„ï¼Œæœ‰æ—¶åŒºçš„å·®åˆ«ï¼Œäºæ˜¯å°†æ—¶é—´æ”¹äº†å›å»ï¼Œè¿™æ‰è§£å†³é—®é¢˜ã€‚
    
    ä¸‹é¢æ˜¯æŸ¥çœ‹ç³»ç»Ÿ(linux)æ—¶é—´å’Œä¿®æ”¹ç³»ç»Ÿæ—¶é—´çš„å‘½ä»¤ï¼š
    
    ``` 
    $ date -R
    Sun, 22 Jan 2017 10:10:36 -0500
    ```
    
    ä¸‹é¢æ˜¯ä¿®æ”¹ç³»ç»Ÿæ—¶é—´çš„å‘½ä»¤ï¼š
    
    ``` 
    $ sudo date --set="2017-01-22 16:16:23"
    Sun 22 Jan 16:16:23 GMT 2017
    ```

## å‚è€ƒé“¾æ¥
ä»¥ä¸‹åœ°å€æœ‰å¯èƒ½è¢«å¢™ ï¼Œè¿™å°±è¦å„ä½çœ‹å®˜è‡ªå·±æƒ³åŠæ³•äº†ğŸ˜‚
1. [å®˜ç½‘åœ°å€](https://www.v2ray.com/)
2. [V2Ray é…ç½®æŒ‡å—](https://toutyrater.github.io/)
3. [V2rayç§‘å­¦ä¸Šç½‘](http://www.gonewto.com/?post/gweuy4)
4. [V2Rayå®Œå…¨ä½¿ç”¨æ•™ç¨‹](https://yuan.ga/v2ray-complete-tutorial/)